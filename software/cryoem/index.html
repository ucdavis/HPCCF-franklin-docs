
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
        <link rel="canonical" href="http://docs.franklin.hpc.ucdavis.edu/software/cryoem/">
      
      
        <link rel="prev" href="../rlang/">
      
      
        <link rel="next" href="../developing/">
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.0, mkdocs-material-9.5.27">
    
    
      
        <title>cryo-EM - Franklin Cluster Documentation</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.6543a935.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="../../stylesheets/extra.css">
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce((e,_)=>(e<<5)-e+_.charCodeAt(0),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="ucdavis" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#cryo-em-software-stack" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Franklin Cluster Documentation" class="md-header__button md-logo" aria-label="Franklin Cluster Documentation" data-md-component="logo">
      
  <img src="../../assets/HPCCF-logo-dark.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3V6m0 5h18v2H3v-2m0 5h18v2H3v-2Z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Franklin Cluster Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              cryo-EM
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="ucdavis" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12c0-2.42-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12 20 8.69Z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var media,input,key,value,palette=__md_get("__palette");if(palette&&palette.color){"(prefers-color-scheme)"===palette.color.media&&(media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']"),palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent"));for([key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.516 6.516 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5Z"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7 0-.24-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91 1.61 0 2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08Z"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12 19 6.41Z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/ucdavis/HPCCF-franklin-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Franklin Cluster Documentation" class="md-nav__button md-logo" aria-label="Franklin Cluster Documentation" data-md-component="logo">
      
  <img src="../../assets/HPCCF-logo-dark.png" alt="logo">

    </a>
    Franklin Cluster Documentation
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/ucdavis/HPCCF-franklin-docs" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6zm-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3zm44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9zM244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8zM97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1zm-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7zm32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1zm-11.4-14.7c-1.6 1-1.6 3.6 0 5.9 1.6 2.3 4.3 3.3 5.6 2.3 1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2z"/></svg>
  </div>
  <div class="md-source__repository">
    GitHub
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    About
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" checked>
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Users
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Users
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../general/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    General
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            General
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../general/access/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Accessing the Cluster
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../general/environment.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    User Environment
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../general/resources.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Available Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../general/storage.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Data Storage
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../scheduler/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Scheduler
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Scheduler
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scheduler/jobs/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Slurm Commands
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scheduler/queues/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Queueing
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scheduler/resources/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Resources
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../scheduler/jobscripts/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Job Scripts
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2_3" checked>
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Software
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Software
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../list/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Software List
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../modules/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Module System
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../conda/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Python and Conda
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../rlang/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    R and RStudio
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    cryo-EM
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    cryo-EM
  </span>
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#relion" class="md-nav__link">
    <span class="md-ellipsis">
      Relion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Relion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#launching-relion" class="md-nav__link">
    <span class="md-ellipsis">
      Launching Relion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependency-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Dependency Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slurm-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Slurm Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switching-between-relion-modules-relion-helper" class="md-nav__link">
    <span class="md-ellipsis">
      Switching Between Relion Modules: relion-helper
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module-variants" class="md-nav__link">
    <span class="md-ellipsis">
      Module Variants
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ctffind" class="md-nav__link">
    <span class="md-ellipsis">
      ctffind
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#motioncor2" class="md-nav__link">
    <span class="md-ellipsis">
      MotionCor2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gctf" class="md-nav__link">
    <span class="md-ellipsis">
      Gctf
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../developing/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Developing Software
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
        
        
      
    
    
    <li class="md-nav__item md-nav__item--section md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Admins
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Admins
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin_storage.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Storage
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin_networking.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Networking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../admin_scheduler.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Scheduler
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#relion" class="md-nav__link">
    <span class="md-ellipsis">
      Relion
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Relion">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#launching-relion" class="md-nav__link">
    <span class="md-ellipsis">
      Launching Relion
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#dependency-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Dependency Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#slurm-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      Slurm Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#switching-between-relion-modules-relion-helper" class="md-nav__link">
    <span class="md-ellipsis">
      Switching Between Relion Modules: relion-helper
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#module-variants" class="md-nav__link">
    <span class="md-ellipsis">
      Module Variants
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#ctffind" class="md-nav__link">
    <span class="md-ellipsis">
      ctffind
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#motioncor2" class="md-nav__link">
    <span class="md-ellipsis">
      MotionCor2
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#gctf" class="md-nav__link">
    <span class="md-ellipsis">
      Gctf
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
  


<h1 id="cryo-em-software-stack"><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.46 6.28 11.05 9c-2.58.26-4.55 2.41-4.55 5a5 5 0 0 0 5 5c2.05 0 3.81-1.23 4.58-3H13.5v-2h8v2h-2.25a8.048 8.048 0 0 1-2.46 4h2.71v2h-16v-2h2.71a7.99 7.99 0 0 1-2.71-6c0-3.63 2.46-6.8 5.96-7.72m3.28-4.21.76 1.3.86-.5 3.5 6.06-3.47 2-3.5-6.06.87-.5-.76-1.3 1.74-1Z"/></svg></span> <span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 2h2v2c0 1.44.68 2.61 1.88 3.78.86.83 2.01 1.63 3.21 2.42l-1.83 1.19C8.27 10.72 7.31 10 6.5 9.21 5.07 7.82 4 6.1 4 4V2m14 0h2v2c0 2.1-1.07 3.82-2.5 5.21-1.41 1.38-3.21 2.52-4.96 3.63-1.75 1.12-3.45 2.21-4.66 3.38C6.68 17.39 6 18.56 6 20v2H4v-2c0-2.1 1.07-3.82 2.5-5.21 1.41-1.38 3.21-2.52 4.96-3.63 1.75-1.12 3.45-2.21 4.66-3.38C17.32 6.61 18 5.44 18 4V2m-3.26 10.61c.99.67 1.95 1.39 2.76 2.18C18.93 16.18 20 17.9 20 20v2h-2v-2c0-1.44-.68-2.61-1.88-3.78-.86-.83-2.01-1.63-3.21-2.42l1.83-1.19M7 3h10v1l-.06.5H7.06L7 4V3m.68 3h8.64c-.24.34-.52.69-.9 1.06l-.51.44H9.07l-.49-.44c-.38-.37-.66-.72-.9-1.06m1.41 10.5h5.84l.49.44c.38.37.66.72.9 1.06H7.68c.24-.34.52-.69.9-1.06l.51-.44m-2.03 3h9.88l.06.5v1H7v-1l.06-.5Z"/></svg></span> Cryo-EM Software Stack<a class="headerlink" href="#cryo-em-software-stack" title="Permanent link">&para;</a></h1>
<h2 id="relion">Relion<a class="headerlink" href="#relion" title="Permanent link">&para;</a></h2>
<p>Franklin has multiple CPU and GPU optimized versions of the <a href="https://relion.readthedocs.io/en/release-4.0/index.html">Relion</a> cryo-EM structural determination package.
The head node has been configured to support X11 forwarding, enabling the Relion GUI to be launched.
Relion jobs are submitted for batch processing on the cluster node via Slurm.
Each Relion module exports the necessary configurations to pre-fill job submission and dependency information in the GUI, and we have defined additional GUI fields to further configure Slurm parameters.
We are also maintaining an additional software package, <a href="https://github.com/ucdavis/relion-helper"><code>relion-helper</code></a>, to assist users in switching between Relion modules within the same project.</p>
<p>Your first step is deciding which Relion variant you should use.
We recommend version <strong>4.0.0</strong>, as it is the currently-supported stable release.
There are three variants of this version: <code>relion/cpu/4.0.0+amd</code>, <code>relion/gpu/4.0.0+amd</code>, and <code>relion/gpu/4.0.0+intel</code>, which correspond to the CPU optimized, GPU with AMD CPU optimized, and GPU with Intel CPU optimized builds, respectively.
More information about these modules is available in the <a href="./#module-variants">Module Variants</a> section.
In general, unless you have access to the three GPU nodes owned by the Al-Bassam lab, you can ignore the Intel variants, and use the CPU <code>+amd</code> version for multi-node CPU only jobs and the GPU <code>+amd</code> version if you have access to a GPU node.</p>
<p>If you are completely unfamiliar with Relion, you should start with the <a href="https://relion.readthedocs.io/en/release-4.0/SPA_tutorial/index.html">tutorial</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Because Relion is GUI driven, you need to <code>ssh</code> to Franklin with X11 forwarding enabled.
Instructions for enabling X11 forwarding can be found in the <a href="../../general/access/#x11-forwarding">Access</a> section.</p>
</div>
<h3 id="launching-relion">Launching Relion<a class="headerlink" href="#launching-relion" title="Permanent link">&para;</a></h3>
<p>Make sure you have loaded one of the Relion modules:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a>$<span class="w"> </span>module<span class="w"> </span>list<span class="w"> </span>relion
<a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a>
<a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a>Currently<span class="w"> </span>Loaded<span class="w"> </span>Modules<span class="w"> </span>Matching:<span class="w"> </span>relion
<a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">  </span><span class="m">1</span><span class="o">)</span><span class="w"> </span>relion/gpu/4.0.0+amd<span class="w">   </span><span class="m">2</span><span class="o">)</span><span class="w"> </span>relion-helper/0.2
</code></pre></div>
<p>Change your working directory your Relion project directory and type <code>relion</code>.
The Relion GUI should then pop up locally.
There will be a bit of latency when using it, especially if you are off campus.
You may be able to reduce latency by <a href="../../general/access/#x11-forwarding">enabling SSH compression</a>.</p>
<figure>
<p><img alt="The Relion start screen." src="../../img/relion_start_gui.png" />
  </p>
<figcaption>The relion start screen.</figcaption>
</figure>
<h3 id="dependency-configuration">Dependency Configuration<a class="headerlink" href="#dependency-configuration" title="Permanent link">&para;</a></h3>
<p>The paths to software that different Relion jobs use will be <em>automatically filled in</em>.
Editing these paths, unless you really, <em>really</em> know what you are doing, is <strong>not</strong> recommended and will likely result in problems, as some of these
dependencies are compiled with architecture-specific flags that match their Relion variant.</p>
<figure>
<p><img alt="dependent program." src="../../img/relion_dep_gui.png" />
  </p>
<figcaption>Pre-filled dependent program path.</figcaption>
</figure>
<div class="admonition danger">
<p class="admonition-title">Danger</p>
<p>If you plan to switch between Relion modules within the same project, <strong>you must <a href="./#switching-between-relion-modules-relion-helper">use the procedure described in the relion-helper section</a></strong>.
Failure to do so <strong>will</strong> result in execution errors.</p>
</div>
<h3 id="slurm-configuration">Slurm Configuration<a class="headerlink" href="#slurm-configuration" title="Permanent link">&para;</a></h3>
<p>Our Relion deployment has additional fields in the <strong>Running</strong> tabs.
These new fields are:</p>
<ul>
<li><strong>Email</strong>: The email to which Slurm will send job status updates. Fills the <code>--mail-user</code> <code>sbatch</code>/<code>srun</code> parameter.</li>
<li><strong>Memory per CPU</strong>: Fills the Slurm <code>--memory-per-cpu</code> parameter. Total RAM use of a job will be <em>(Number of MPI procs)</em> * <em>(Number of Threads)</em> * <em>(Memory per CPU)</em>, when the <strong>Number of Threads</strong> field is available; otherwise it will be  <em>(Number of MPI procs)</em> * <em>(Memory per CPU)</em>.</li>
<li><strong>Job Time</strong>: Fills Slurm's <code>--time</code> parameter.</li>
<li><strong>GPU Resources</strong>: Only available in the GPU modules. Number (and optionally type) of GPUs to request for this job. If only an integer is supplied, will request any GPU. If <code>TYPE:NUM</code> is supplied (example: <code>a4000:4</code>), specific models of GPU will be requested. See the <a href="../../scheduler/resources/"><strong>Resources</strong></a> section for more information on available GPU types.</li>
</ul>
<div class="tabbed-set tabbed-alternate" data-tabs="1:2"><input checked="checked" id="__tabbed_1_1" name="__tabbed_1" type="radio" /><input id="__tabbed_1_2" name="__tabbed_1" type="radio" /><div class="tabbed-labels"><label for="__tabbed_1_1">CPU Build</label><label for="__tabbed_1_2">GPU Build</label></div>
<div class="tabbed-content">
<div class="tabbed-block">
<p><figure markdown>
<img alt="Relion GUI running screen, CPU version" src="../../img/relion_running_cpu.png" />
<figcaption>The <code>relion/cpu</code> modules lack the GPU resources field. Note the submission script as well.</figcaption>
</figure></p>
</div>
<div class="tabbed-block">
<p><figure markdown>
<img alt="Relion GUI running screen, GPU version" src="../../img/relion_running_gpu.png" />
<figcaption>The <code>relion/gpu</code> module has an extra field for GPU resources. Also note the differing submission script.</figcaption>
</figure></p>
</div>
</div>
</div>
<p>The default GUI fields serve their original purposes:</p>
<ul>
<li><strong>Number of MPI procs</strong>: This will fill the Slurm <code>--ntasks</code> parameter. These tasks may be distributed across multiple nodes, depending on the number of <strong>Threads</strong> requested. For GPU runs, this should be the number of GPUs <strong>+ 1</strong>.</li>
<li><strong>Number of Threads</strong>: The will fill the Slurm <code>--cpus-per-task</code> parameter, which means it is the <em>number of threads per MPI proc</em>. Some job types do not expose this field, as they can only be run with a single-thread per MPI proc.</li>
<li><strong>Queue name</strong>: The Slurm partition to submit to, filling the <code>--partition</code> parameter. More information on partitions can be found in the <a href="../../scheduler/queues/"><strong>Queueing</strong></a> section.</li>
<li><strong>Standard submission script</strong>: The location of the Slurm job script template that will be used. This field will be filled with the appropriate template for the loaded Relion module by default, and should not be changed.<em>For advanced users only:</em> if you are familiar with Relion and want to further fine-tune your Slurm scripts, you can write your own based on the provided templates found in <code>/share/apps/spack/templates/hpccf/franklin</code> or <a href="https://github.com/ucdavis/spack-ucdavis/tree/main/templates/hpccf/franklin">in our spack GitHub repo</a>.</li>
<li><strong>Minimum dedicated cores per node</strong>: Unused on our system.</li>
</ul>
<h3 id="switching-between-relion-modules-relion-helper">Switching Between Relion Modules: relion-helper<a class="headerlink" href="#switching-between-relion-modules-relion-helper" title="Permanent link">&para;</a></h3>
<p>Sometimes, you may wish to use different Relion modules for different tasks while working within the same project -- 
perhaps you'd prefer to use the CPU-optimized version for CTF estimation and the GPU-optimized version for 3D refinement.
<strong>This does not work out of the box</strong>.
Relion fills the filesystem paths of its dependencies and templates from environment variables, and those environment
variables are set in the <a href="../modules/#intro">modulefiles</a> of the differing Relion builds.
However, when a Relion job is run, those paths are cached in hidden <code>.star</code> files in the project directory, and
the <em>next time</em> Relion is run, it fills those paths from the cache files instead of the environment variables.
This means that, after switching modules, the cached location of the <em>previous</em> module will be used, instead of the
exported environment variables from the <em>new</em> module.
<strong>This causes major breakage</strong> due to dependencies having different compilation options to match the parent Relion
they are attached to and Slurm templates having different configuration options available.</p>
<p>Luckily, we have a solution!
We wrote and are maintaining <a href="https://github.com/ucdavis/relion-helper">relion-helper</a>, a simple utility that updates
the cached variables in a project to match whatever Relion module is currently loaded.
Let's go over example use of the tool.</p>
<p>In this example, assume we have a relion project directory at <code>/path/to/my/project</code>.
We ran some steps with the module <code>relion/gpu/4.0.0+amd</code>, and now want to switch to <code>relion/cpu/4.0.0+amd</code>.
First, let's swap modules:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="gp">$ </span>module<span class="w"> </span>unload<span class="w"> </span>relion/gpu/4.0.0+amd<span class="w"> </span>
<a id="__codelineno-1-2" name="__codelineno-1-2" href="#__codelineno-1-2"></a><span class="go">amdfftw/3.2+amd: unloaded.</span>
<a id="__codelineno-1-3" name="__codelineno-1-3" href="#__codelineno-1-3"></a><span class="go">ctffind/4.1.14+amd: unloaded.</span>
<a id="__codelineno-1-4" name="__codelineno-1-4" href="#__codelineno-1-4"></a><span class="go">relion/gpu/4.0.0+amd: unloaded.</span>
<a id="__codelineno-1-5" name="__codelineno-1-5" href="#__codelineno-1-5"></a><span class="go">motioncor2/1.5.0: unloaded.</span>
<a id="__codelineno-1-6" name="__codelineno-1-6" href="#__codelineno-1-6"></a><span class="go">gctf/1.06: unloaded.</span>
<a id="__codelineno-1-7" name="__codelineno-1-7" href="#__codelineno-1-7"></a><span class="go">ghostscript/9.56.1: unloaded.</span>
<a id="__codelineno-1-8" name="__codelineno-1-8" href="#__codelineno-1-8"></a>
<a id="__codelineno-1-9" name="__codelineno-1-9" href="#__codelineno-1-9"></a><span class="gp">$ </span>module<span class="w"> </span>load<span class="w"> </span>relion/cpu/4.0.0+amd.lua<span class="w"> </span>
<a id="__codelineno-1-10" name="__codelineno-1-10" href="#__codelineno-1-10"></a><span class="go">amdfftw/3.2+amd: loaded.</span>
<a id="__codelineno-1-11" name="__codelineno-1-11" href="#__codelineno-1-11"></a><span class="go">ctffind/4.1.14+amd: loaded.</span>
<a id="__codelineno-1-12" name="__codelineno-1-12" href="#__codelineno-1-12"></a><span class="go">relion/cpu/4.0.0+amd: loaded.</span>
<a id="__codelineno-1-13" name="__codelineno-1-13" href="#__codelineno-1-13"></a><span class="go">motioncor2/1.5.0: loaded.</span>
<a id="__codelineno-1-14" name="__codelineno-1-14" href="#__codelineno-1-14"></a><span class="go">gctf/1.06: loaded.</span>
<a id="__codelineno-1-15" name="__codelineno-1-15" href="#__codelineno-1-15"></a><span class="go">ghostscript/9.56.1: loaded.</span>
</code></pre></div>
<p>And load relion-helper:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="gp">$ </span>module<span class="w"> </span>load<span class="w"> </span>relion-helper<span class="w"> </span>
<a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="go">relion-helper/0.2: loaded.</span>
<a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a>
<a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="gp">$ </span>relion-helper<span class="w"> </span>-h
<a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="go">usage: relion-helper [-h] {reset-cache} ...</span>
<a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a>
<a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="go">positional arguments:</span>
<a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="go">  {reset-cache}</span>
<a id="__codelineno-2-9" name="__codelineno-2-9" href="#__codelineno-2-9"></a>
<a id="__codelineno-2-10" name="__codelineno-2-10" href="#__codelineno-2-10"></a><span class="go">options:</span>
<a id="__codelineno-2-11" name="__codelineno-2-11" href="#__codelineno-2-11"></a><span class="go">  -h, --help     show this help message and exit</span>
</code></pre></div>
<p>Now, change to the project directory:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="gp">$ </span><span class="nb">cd</span><span class="w"> </span>/path/to/my/project
</code></pre></div>
<p>Then, run the utility. 
It will pull the updated values from the appropriate environment variables that were exported by the new module
and write them to the cache files in-place.</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="gp">$ </span>relion-helper<span class="w"> </span>reset-cache
<a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="go">&gt; .gui_ctffindjob.star:41:</span>
<a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="go">  qsub_extra2: 2 =&gt; 10000</span>
<a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="go">&gt; .gui_ctffindjob.star:42:</span>
<a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="go">  qsub_extra3: 10000 =&gt; 12:00:00</span>
<a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="go">&gt; .gui_ctffindjob.star:43:</span>
<a id="__codelineno-4-7" name="__codelineno-4-7" href="#__codelineno-4-7"></a><span class="go">  qsubscript: /share/apps/spack/templates/hpccf/franklin/relion.4.0.0.gpu.zen2.slurm.template.sh =&gt; </span>
<a id="__codelineno-4-8" name="__codelineno-4-8" href="#__codelineno-4-8"></a><span class="go">/share/apps/spack/templates/hpccf/franklin/relion.4.0.0.cpu.slurm.template.sh</span>
<a id="__codelineno-4-9" name="__codelineno-4-9" href="#__codelineno-4-9"></a><span class="go">&gt; .gui_class2djob.star:53:</span>
<a id="__codelineno-4-10" name="__codelineno-4-10" href="#__codelineno-4-10"></a><span class="go">  qsub_extra2: 2 =&gt; 10000</span>
<a id="__codelineno-4-11" name="__codelineno-4-11" href="#__codelineno-4-11"></a><span class="go">&gt; .gui_class2djob.star:54:</span>
<a id="__codelineno-4-12" name="__codelineno-4-12" href="#__codelineno-4-12"></a><span class="go">  qsub_extra3: 10000 =&gt; 12:00:00</span>
<a id="__codelineno-4-13" name="__codelineno-4-13" href="#__codelineno-4-13"></a><span class="go">&gt; .gui_class2djob.star:55:</span>
<a id="__codelineno-4-14" name="__codelineno-4-14" href="#__codelineno-4-14"></a><span class="go">  qsubscript: /share/apps/spack/templates/hpccf/franklin/relion.4.0.0.gpu.zen2.slurm.template.sh =&gt; </span>
<a id="__codelineno-4-15" name="__codelineno-4-15" href="#__codelineno-4-15"></a><span class="go">/share/apps/spack/templates/hpccf/franklin/relion.4.0.0.cpu.slurm.template.sh</span>
<a id="__codelineno-4-16" name="__codelineno-4-16" href="#__codelineno-4-16"></a><span class="go">&gt; .gui_autopickjob.star:63:</span>
<a id="__codelineno-4-17" name="__codelineno-4-17" href="#__codelineno-4-17"></a><span class="go">  qsub_extra2: 2 =&gt; 10000</span>
<a id="__codelineno-4-18" name="__codelineno-4-18" href="#__codelineno-4-18"></a><span class="go">&gt; .gui_autopickjob.star:64:</span>
<a id="__codelineno-4-19" name="__codelineno-4-19" href="#__codelineno-4-19"></a><span class="go">  qsub_extra3: 10000 =&gt; 12:00:00</span>
<a id="__codelineno-4-20" name="__codelineno-4-20" href="#__codelineno-4-20"></a><span class="go">&gt; .gui_autopickjob.star:65:</span>
<a id="__codelineno-4-21" name="__codelineno-4-21" href="#__codelineno-4-21"></a><span class="go">  qsubscript: /share/apps/spack/templates/hpccf/franklin/relion.4.0.0.gpu.zen2.slurm.template.sh =&gt; </span>
<a id="__codelineno-4-22" name="__codelineno-4-22" href="#__codelineno-4-22"></a><span class="go">/share/apps/spack/templates/hpccf/franklin/relion.4.0.0.cpu.slurm.template.sh</span>
<a id="__codelineno-4-23" name="__codelineno-4-23" href="#__codelineno-4-23"></a><span class="go">&gt; .gui_importjob.star:38:</span>
<a id="__codelineno-4-24" name="__codelineno-4-24" href="#__codelineno-4-24"></a><span class="go">  qsub_extra2: 2 =&gt; 10000</span>
<a id="__codelineno-4-25" name="__codelineno-4-25" href="#__codelineno-4-25"></a><span class="go">...</span>
</code></pre></div>
<p>The above output is truncated for brevity.
For each cached variable it updates, it reports the name of the cache file, the line number of the change, and the 
variable name and value of the change.
You can now launch Relion and continue with your work.</p>
<p><strong>Each time you want to switch Relion modules for a project</strong>, you will need to run this after loading the new module.</p>
<p>For now, relion-helper only has the <code>reset-cache</code> subcommand.
You can skip <code>cd</code>ing to the project directory by passing the project directory to it instead:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="gp">$ </span>relion-helper<span class="w"> </span>reset-cache<span class="w"> </span>-p<span class="w"> </span>/path/to/my/project
</code></pre></div>
<p>Although the changes are made in-place, it leaves backups of the modified files, in case you are concerned about bugs.
The original files are of the form <code>.gui_[JOBNAME].star</code>, and the backups are suffixed with <code>.bak</code>:</p>
<div class="highlight"><pre><span></span><code><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="gp">$ </span>ls<span class="w"> </span>-al<span class="w"> </span>/path/to/my/project
<a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="go">total 317</span>
<a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="go">drwxrwxr-x 10 camw camw   31 Feb  3 10:02 .</span>
<a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="go">drwxrwxr-x  4 camw camw    6 Jan 12 12:58 ..</span>
<a id="__codelineno-6-5" name="__codelineno-6-5" href="#__codelineno-6-5"></a><span class="go">drwxrwxr-x  5 camw camw    5 Jan 12 12:46 .Nodes</span>
<a id="__codelineno-6-6" name="__codelineno-6-6" href="#__codelineno-6-6"></a><span class="go">drwxrwxr-x  2 camw camw    2 Jan 12 12:40 .TMP_runfiles</span>
<a id="__codelineno-6-7" name="__codelineno-6-7" href="#__codelineno-6-7"></a><span class="go">-rw-rw-r--  1 camw camw 1959 Feb  3 10:02 .gui_autopickjob.star</span>
<a id="__codelineno-6-8" name="__codelineno-6-8" href="#__codelineno-6-8"></a><span class="go">-rw-rw-r--  1 camw camw 1957 Feb  3 10:01 .gui_autopickjob.star.bak</span>
<a id="__codelineno-6-9" name="__codelineno-6-9" href="#__codelineno-6-9"></a><span class="go">-rw-rw-r--  1 camw camw 1427 Feb  3 10:02 .gui_class2djob.star</span>
<a id="__codelineno-6-10" name="__codelineno-6-10" href="#__codelineno-6-10"></a><span class="go">-rw-rw-r--  1 camw camw 1425 Feb  3 10:01 .gui_class2djob.star.bak</span>
<a id="__codelineno-6-11" name="__codelineno-6-11" href="#__codelineno-6-11"></a><span class="go">-rw-rw-r--  1 camw camw 1430 Feb  3 10:02 .gui_ctffindjob.star</span>
<a id="__codelineno-6-12" name="__codelineno-6-12" href="#__codelineno-6-12"></a><span class="go">-rw-rw-r--  1 camw camw 1428 Feb  3 10:01 .gui_ctffindjob.star.bak</span>
<a id="__codelineno-6-13" name="__codelineno-6-13" href="#__codelineno-6-13"></a><span class="go">...</span>
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>We <strong>do not recommend</strong> changing between major Relion versions within the same project: ie, from 3.0.1 to 4.0.0.</p>
</div>
<h3 id="module-variants">Module Variants<a class="headerlink" href="#module-variants" title="Permanent link">&para;</a></h3>
<p>There are currently six variations of Relion available on Franklin.
Versions <strong>3.1.3</strong> and <strong>4.0.0</strong> are available, each with:</p>
<ul>
<li>A CPU-optimized build compiled for AMD processors: <code>relion/cpu/[VERSION]+amd</code></li>
<li>A GPU-optimized build compiled for AMD processors: <code>relion/gpu/[VERSION]+amd</code></li>
<li>A GPU-optimized build compiled for Intel processors: <code>relion/gpu/[VERSION]+intel</code></li>
</ul>
<p>The CPU-optimized builds were configured with <code>-DALTCPU=True</code> and without CUDA support.
For Relion CPU jobs, they will be much faster than the GPU variants.
The AMD-optimized <code>+amd</code> variants were compiled with <code>-DAMDFFTW=ON</code> and linked against the <a href="https://github.com/amd/amd-fftw"><code>amdfftw</code></a> implementation of  <a href="https://www.fftw.org/"><code>FFTW</code></a>, in addition to having Zen 2 microarchitecture flags specified to GCC.
The <code>+intel</code> variants were compiled with AVX2 support and configured with the <code>-DMKLFFT=True</code> flag, so they use the <a href="https://www.intel.com/content/www/us/en/develop/documentation/oneapi-programming-guide/top/api-based-programming/intel-oneapi-math-kernel-library-onemkl.html">Intel OneAPI MKL</a> implementation of <code>FFTW</code>.
All the GPU variants are targeted to a CUDA compute version of 7.5.
The full Cryo-EM software stack is defined in the HPCCF <a href="https://github.com/ucdavis/spack-ucdavis/blob/main/environments/hpccf/franklin/cryoem/spack.yaml">spack configuration repository</a>, and we maintain our own <a href="https://github.com/ucdavis/spack-ucdavis/blob/main/repos/hpccf/packages/relion/package.py">Relion spack package definition</a>.
More information on the configurations described here can be found in <a href="https://relion.readthedocs.io/en/release-4.0/Installation.html#configuration-options">the Relion docs</a>.</p>
<p>The different modules may need to be used with different Slurm resource directives, depending on their variants.
The necessary directives, given a module and job partition, are as follows:</p>
<table>
<thead>
<tr>
<th>Module Name</th>
<th>Slurm Partition</th>
<th>Slurm Directives</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>relion/cpu/[3.1.3,4.0.0]+amd</code></td>
<td><code>low</code></td>
<td><code>--constraint=amd</code></td>
</tr>
<tr>
<td><code>relion/cpu/[3.1.3,4.0.0]+amd</code></td>
<td><code>high</code></td>
<td>N/A</td>
</tr>
<tr>
<td><code>relion/gpu/[3.1.3,4.0.0]+amd</code></td>
<td><code>low</code></td>
<td><code>--constraint=amd --gres=gpu:[$N_GPUs]</code> or <code>--gres=gpu:[a4000,a5000]:[$N_GPUs]</code></td>
</tr>
<tr>
<td><code>relion/gpu/[3.1.3,4.0.0]+amd</code></td>
<td><code>jalettsgrp-gpu</code></td>
<td><code>--gres=gpu:[$N_GPUs]</code></td>
</tr>
<tr>
<td><code>relion/gpu/[3.1.3,4.0.0]+amd</code></td>
<td><code>mmgdept-gpu</code></td>
<td><code>--gres=gpu:[$N_GPUs]</code></td>
</tr>
<tr>
<td><code>relion/gpu/[3.1.3,4.0.0]+intel</code></td>
<td><code>low</code></td>
<td><code>--constraint=intel --gres=gpu:[$N_GPUs]</code> or <code>--gres=gpu:[rtx_2080_ti]:[$N_GPUs]</code></td>
</tr>
<tr>
<td><code>relion/gpu/[3.1.3,4.0.0]+intel</code></td>
<td><code>jawdatgrp-gpu</code></td>
<td><code>--gres=gpu:[$N_GPUs]</code></td>
</tr>
</tbody>
</table>
<p>For example, to use the CPU-optimized Relion module <code>relion/cpu/4.0.0+amd</code> on the free, preemptable <code>low</code> partition, you should submit jobs with <code>--constraint=amd</code> so as to eliminate the Intel nodes in that partition from consideration.
However, if you have access to and are using the <code>high</code> partition with the same module, no additional Slurm directives are required, as the <code>high</code> partition only has CPU compute nodes.
Alternatively, if you were using an AMD-optimized GPU version, like <code>relion/gpu/4.0.0+amd</code>, and wished to use 2 GPUs on the <code>low</code> partition, you would need to provide both the <code>--constraint=amd</code> and a <code>--gres=gpu:2</code> directive, in order to get an AMD node on the partition along with the required GPUs.
Those with access to and submitting to the <code>mmgdept-gpu</code> queue would need only to specify <code>--gres=gpu:2</code>, as that partition only has AMD nodes in it.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you are submitting jobs via the GUI, these Slurm directives will already be taken care of for you.
If you wish to submit jobs manually, you can get the path to Slurm submission template for the currently-loaded module from the <code>$RELION_QSUB_TEMPLATE</code>
environment variable; copying this template is a good starting place for building your batch scripts.</p>
</div>
<h2 id="ctffind">ctffind<a class="headerlink" href="#ctffind" title="Permanent link">&para;</a></h2>
<p>Our installation of <a href="https://grigoriefflab.umassmed.edu/ctffind4">CTFFIND4</a> has <code>+amd</code> and <code>+intel</code> variants
which, like Relion, are linked against <code>amdfftw</code> and Intel OneAPI MKL, respectively.
The Slurm <code>--constraint</code> flags should be used with these as well, when appropriate, as indicated in the Relion directive table.
Each Relion module has its companion CTFFIND4 module as a dependency, so the appropriate version will automatically be
loaded when you load Relion, and the proper environment variables are set for the Relion GUI to point at them.</p>
<h2 id="motioncor2">MotionCor2<a class="headerlink" href="#motioncor2" title="Permanent link">&para;</a></h2>
<p>We have deployed <a href="https://emcore.ucsf.edu/ucsf-software">MotionCor2</a> binaries which have been patched to link against the appropriate version of CUDA.
These are targetted at a generic architecture, as the source code is not available.
Like CTFFIND4, this module is brought in by Relion and the proper environment variables set for Relion to use it.</p>
<h2 id="gctf">Gctf<a class="headerlink" href="#gctf" title="Permanent link">&para;</a></h2>
<p><a href="https://pubmed.ncbi.nlm.nih.gov/26592709/">Gctf</a> binaries have been patched and deployed in the same manner as MotionCor2.</p>







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1-2.1-2M12.5 7v5.2l4 2.4-1 1L11 13V7h1.5M11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2v1.8Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">June 26, 2024</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3h-2Z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">June 26, 2024</span>
  </span>

    
    
    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12Z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../rlang/" class="md-footer__link md-footer__link--prev" aria-label="Previous: R and RStudio">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11h12Z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                R and RStudio
              </div>
            </div>
          </a>
        
        
          
          <a href="../developing/" class="md-footer__link md-footer__link--next" aria-label="Next: Developing Software">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Developing Software
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11H4Z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2023 The Regents of the University of California, Davis
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
    <a href="mailto:hpc-help@ucdavis.edu" target="_blank" rel="noopener" title="Email HPCCF Support" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 12.13c-.15.01-.29.06-.39.17l-1 1 2.05 2 1-1c.22-.21.22-.56 0-.77l-1.24-1.23a.557.557 0 0 0-.38-.17m-2 1.75L13 19.94V22h2.06l6.06-6.07M20 4H4a2 2 0 0 0-2 2v12a2 2 0 0 0 2 2h7v-.89l8.24-8.22c.47-.49 1.12-.76 1.8-.76.34 0 .68.06 1 .19V6c0-1.12-.92-2-2.04-2m0 4-8 5-8-5V6l8 5 8-5"/></svg>
    </a>
  
    
    
    
    
    <a href="https://ucdavis.slack.com/archives/C053NKA88" target="_blank" rel="noopener" title="#hpc Channel on ucdavis.slack.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.5.2 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M94.12 315.1c0 25.9-21.16 47.06-47.06 47.06S0 341 0 315.1c0-25.9 21.16-47.06 47.06-47.06h47.06v47.06zm23.72 0c0-25.9 21.16-47.06 47.06-47.06s47.06 21.16 47.06 47.06v117.84c0 25.9-21.16 47.06-47.06 47.06s-47.06-21.16-47.06-47.06V315.1zm47.06-188.98c-25.9 0-47.06-21.16-47.06-47.06S139 32 164.9 32s47.06 21.16 47.06 47.06v47.06H164.9zm0 23.72c25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06H47.06C21.16 243.96 0 222.8 0 196.9s21.16-47.06 47.06-47.06H164.9zm188.98 47.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06s-21.16 47.06-47.06 47.06h-47.06V196.9zm-23.72 0c0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06V79.06c0-25.9 21.16-47.06 47.06-47.06 25.9 0 47.06 21.16 47.06 47.06V196.9zM283.1 385.88c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06-25.9 0-47.06-21.16-47.06-47.06v-47.06h47.06zm0-23.72c-25.9 0-47.06-21.16-47.06-47.06 0-25.9 21.16-47.06 47.06-47.06h117.84c25.9 0 47.06 21.16 47.06 47.06 0 25.9-21.16 47.06-47.06 47.06H283.1z"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": ["content.code.annotate", "navigation.sections", "navigation.expand", "navigation.indexes", "navigation.top", "navigation.footer", "navigation.tracking", "search.highlight", "search.share", "search.suggest"], "search": "../../assets/javascripts/workers/search.b8dbb3d2.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.ad660dcc.min.js"></script>
      
        <script src="../../javascripts/mathjax.js"></script>
      
        <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
      
        <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
      
    
  </body>
</html>